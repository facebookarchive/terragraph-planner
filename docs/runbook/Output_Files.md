# Output Files
This page describes all the possible output files from the Terragraph Planner,
including topology kml file, reporting csv files, and ILP problem files.

## Topology KML File

The `Topology` object can be exported in the KML format by [write_to_kml_file](https://github.com/terragraph/terragraph-planner/blob/main/terragraph_planner/common/data_io/topology_serializer.py).
There are different kinds of topologies that represent different stages in a
planner, such as candidate topology and reporting topology.

The candidate topology is a topology that is generated by a LOS analysis plan
and can be directly used as an input in a optimization plan. The reporting
topology or an optimized topology is the final topology of an end-to-end plan
or optimization plan that has been optimized but still contain candidate site
and link information.

### Visualization

All the output KML files can be visualized with Google Earth or other GIS tools
like QGIS.

The output topology KML files primarily provides 3 kinds of information, which
are site information, link information and demand information. The figure below
is a example of the folder structure of the output topology kml file in the
Google Earth.

<p align="center">
    <img src="../figures/output-files-topology-kml-folder.png" width="40%" />
</p>

As is shown above, the top folders are named as status of the sites and links,
and a demand folder. Under the status folders, there are CN sites, DN sites,
POP sites, WIRELESS_BACKHAUL Links, WIRELESS_ACCESS Links and ETHERNET Links
(which is not shown in the example), which contain the placemarks and lines
to represent the corresponding sites or links with the spefic status and type.
The Demand folder shows the demand sites and connections to the physical
sites in the corresponding subfolders.

Each site or link has its own attributes in the data field. You are able to
view its data field by click it.

### Site Attributes

1. **Site Type**: Type of the site, which can be `CN`, `DN` or `POP`.
2. **Site Geohash**: A hash indicating the location of the site.
3. **Altitude**: Altitude reletive to the mean sea level in meters. `N/A` if the
   altitude is not determined.
4. **Status**: Status type of the site, which can be `EXISTING`, `PROPOSED`,
   `CANDIDATE`, `UNREACHABLE` or `UNAVAILABLE`.
5. **Polarity**: Polarity of the site, which can be `ODD`, `EVEN` or `UNASSIGNED`.
6. **Location Type**: Type of the location, which can be `ROOFTOP`, `STREET_LEVEL`
    or `UNKNOWN`.
7. **Device SKU**: The SKU of the device mounted on this site.
8. **Number of Subscribers**: Number of the demand points subscribed to this site.

### Link Attributes

1. **Link Type**: Type of the link, which can be `WIRELESS_BACKHAUL`, `WIRELESS_ACCESS`
   or `ETHERNET`. If the link represents a wired connection, then we assign its
   type to be ETHERNET. If the connection is wireless and both end-sites are DNs
   (or POPs), then it is assumed to be a WIRELESS_BACKHAUL link. If the wireless
   link is between a DN and a CN, then it is an WIRELESS_ACCESS link.
2. **Tx Site Name**: The name of the tx site.
3. **Rx Site Name**: The name of the rx site.
4. **Status**: Status type of the link, which can be `EXISTING`, `PROPOSED`,
   `CANDIDATE`, `UNREACHABLE` or `UNAVAILABLE`.
5. **Distance**: Length of the link in meters.
6. **Data flow (Gbps)**: Estimated data flow on the link in Gbps.
7. **Throughput (Gbps)**: The throughput of the link in Gbps.
8. **Utilization**: Data flow divided by the throughput value. In other words, the
   estimated percentage of link capacity that will be utilized.
9. **Tx Beam Azimuth**: Azimuth of the link in tx->rx direction.
10. **Rx Beam Azimuth**: Azimuth of the link in rx->tx direction. We added this
    since it is hard to tell the direction of a link on Google Earth.
11. **Deviation from Tx Boresight**: The angle (in degrees) between the horizontal
    orientation of the tx sector and the link.
12. **Deviation from Rx Boresight**: The angle (in degrees) between the horizontal
    orientation of the rx sector and the link.
13. **Deviation from El Boresight**: The vertical angle (in degrees) between the
    link and the horizontal axis. We assume that the equipment is mounted
    parallel to the ground.
14. **Tx Power (dBm)**: The tx power assigned to this link. We find the lowest
    tx power that can support the estimated MCS level.
15. **Estimated MCS**: Estimated MCS level of this link.
16. **Estimated SNR (dB)**: Estimated signal-to-noise ratio of this link.
17. **Estimated SINR (dB)**: Estimated signal-to-noise-interference ratio of
    this link.
18. **Estimated RSL**: Estimated received signal level of this link.
19. **Confidence Level**: A number between 0 and 1 to indicate how confident
    the planner is about that the link is a valid LOS link.
20. **Channel**: The channel used for this link.

## Reporting CSV Files

There are 3 kinds of different output CSV files for reporting purpose, which
are site file, link file and sector file.

### Site CSV File

Contains site level information.

1. **Site Geohash**: A hash indicating the location of the site.
2. **Status**: Status type of the site, which can be `EXISTING`, `PROPOSED`,
   `CANDIDATE`, `UNREACHABLE` or `UNAVAILABLE`.
3. **Lat**: The latitude of the site location.
4. **Lon**: The longitude of the site location.
5. **Altitude**: Altitude reletive to the mean sea level in meters. `N/A` if the
   altitude is not determined.
6. **Site Type**: Type of the site, which can be `CN`, `DN` or `POP`.
7. **Polarity**: Polarity of the site, which can be `ODD`, `EVEN` or `UNASSIGNED`.
8. **Outages Caused**: Number of demand sites that would lose their connection to
   any of the active POPs if this site were to go down.
9.  **Site Capex**: The capital expenditure of the site.
10. **Active Nodes**: Number of active nodes on this site.
11. **Active Sectors**: Number of active sectors on this site.
12. **Active Links**: Number of active wireless links supported by this site.
13. **Hops to Nearest Pop**: Number of hops (DN sites) a signal has to travel
    from the closest active (proposed/existing) POP site.
14. **Building Id**: The id of the building where the site is mounted. `N/A` if the site
    is not mounted on the building rooftop.
15. **Device SKU**: The SKU of the device mounted on this site.
16. **Number of Subscribers**: Number of the demand points subscribed to this site.
17. **Name**: The name of the site. If the site name is provided by the input, the planner
    will keep it. Otherwise, an internal id is used as the name.
18. **Outgoing Flow**: The outgoing flow from this site in Gbps.
19. **Incoming Flow**: The incoming flow into this site in Gbps.

### Link CSV File

Contains link (undirected) level information.

1. **Link Geohash**: Unique link hash that is formed by the geohashes of
   the sites that create it.
2. **Link Type**: The type of link.
3. **Status**: The status type of the link.
4. **Tx Site Name**: The name of the tx site.
5. **Rx Site Name**: The name of the rx site.
6. **Distance**: Distance between the sites that form the link.
7.  **Data Flow (Gbps)**: An estimated data flow on the link for reaching the
   maximum bandwidth on the whole graph.
8. **Throughput (Gbps)**: Throughput of the link (in Gbps). This value is computed
   using the estimated SINR value.
9. **Utilization**: Estimated percent of the link throughput used
   if the maximum bandwidth on the whole graph is achieved.
10. **Tx Beam Azimuth**: Azimuth of the link in tx->rx direction.
11. **Rx Beam Azimuth**: Azimuth of the link in rx->tx direction.
12. **Deviation from Tx Boresight**: The angle (in degrees) between the horizontal
    orientation of the tx sector and the link.
13. **Deviation from Rx Boresight**: The angle (in degrees) between the horizontal
    orientation of the rx sector and the link.
14. **Deviation from El Boresight**: The vertical angle (in degrees) between the
    link and the horizontal axis. We assume that the equipment is mounted
    parallel to the ground.
15.	**Tx Power (dBm)**: Minimum Tx power needed to achieve the estimated MCS.
16.	**Estimated MCS**: Estimated modulation and coding scheme.
17.	**Estimated SNR (dB)**: Estimated signal-to-noise ratio in log scale.
18.	**Estimated SINR (dB)**: Estimated signal-to-interference and noise ratio in
    log scale.
19.	**Estimated RSL**: Received signal level estimated on the link.
20.	**Sectors**: IDs of the tx and rx sectors that form this link. You may
    refer to the csv file containing sector level information to learn more
    about these sectors.
21. **Outages Caused**: Number of demand sites that would lose their connection to
    any of the active POPs if this link were to go down.
22. **Confidence Level**: A number between 0 and 1 to indicate how confident
    the planner is about that the link is a valid LOS link.
23. **Channel**: The channel used for this link.
24. **Violates Diff Sector Angle Rule**: True if the link violates the minimum
    angle threshold to another link on the same site, false otherwise.
25. **Violates Near-Far Rule**: True if the link violates the near far rule,
    false otherwise.
26. **Violates Sector Link Limit**: True if the link is associated with a sector
    that is overloaded in terms of the number of DN-DN and DN-CN connections allowed.

### Sector CSV File

Contains sector level information.

1. **Sector ID**: Unique ID of the sector.
2. **Node ID**: Identifying index of which node on the site contains the sector.
3. **Sector Position** The position, from 0, of the sector in the node.
4. **Site Geohash**: The unique geohash of the site this sector is on.
5. **Status**: The status type of the sector.
6. **Azimuth Orientation**: Horizontal orientation of the sector.
7. **Polarity**: The polarity of the site that this sector is on.
8. **Channel**: The channel used for this sector.
9. **Node Cost**: CAPEX cost associated with the node containing the sector.
10. **Active Backhaul Links**: Number of active backhaul links associated
    with the sector.
11. **Active Access Links**: Number of active access links associated with
    the sector.
12. **Site Type**: Type of the site this sector is mounted on.
13. **Violates Link Load**: True if the sector has more active links than allowed.

## ILP Problem Files

ILP problem files are files proceduced by xpress and describe the ILP problem
with objective, constraints and variables. You can get all the problem files
for debug purpose by set the `debug_mode` of `SystemParams` as True.
